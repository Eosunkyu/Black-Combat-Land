{% extends "layout.html" %}

{% block title %}BLACK COMBAT LAND - 아이디/비밀번호 찾기{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header bg-dark text-white">
                    <h4 class="mb-0">계정 정보 찾기</h4>
                </div>
                <div class="card-body">
                    <ul class="nav nav-tabs" id="accountTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="find-id-tab" data-bs-toggle="tab" data-bs-target="#find-id" 
                                type="button" role="tab" aria-controls="find-id" aria-selected="true">아이디 찾기</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="find-pw-tab" data-bs-toggle="tab" data-bs-target="#find-pw" 
                                type="button" role="tab" aria-controls="find-pw" aria-selected="false">비밀번호 찾기</button>
                        </li>
                    </ul>
                    
                    <div class="tab-content mt-4" id="accountTabsContent">
                        <!-- 아이디 찾기 탭 -->
                        <div class="tab-pane fade show active" id="find-id" role="tabpanel" aria-labelledby="find-id-tab">
                            {% if id_message %}
                            <div class="alert alert-{{ id_message_type }}">{{ id_message }}</div>
                            {% endif %}
                            
                            <form action="{{ url_for('auth.find_id') }}" method="post">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                <div class="mb-3">
                                    <label for="email" class="form-label">이메일</label>
                                    <input type="email" class="form-control" id="email" name="email" required>
                                    <div class="form-text">가입시 등록한 이메일을 입력하세요.</div>
                                </div>
                                <div class="mb-3">
                                    <label for="nickname" class="form-label">닉네임</label>
                                    <input type="text" class="form-control" id="nickname" name="nickname" required>
                                    <div class="form-text">가입시 등록한 닉네임을 입력하세요.</div>
                                </div>
                                <button type="submit" class="btn btn-primary">아이디 찾기</button>
                            </form>
                        </div>
                        
                        <!-- 비밀번호 찾기 탭 -->
                        <div class="tab-pane fade" id="find-pw" role="tabpanel" aria-labelledby="find-pw-tab">
                            {% if pw_message %}
                            <div class="alert alert-{{ pw_message_type }}">{{ pw_message }}</div>
                            {% endif %}
                            
                            <form action="{{ url_for('auth.reset_password') }}" method="post">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                <div class="mb-3">
                                    <label for="username" class="form-label">아이디</label>
                                    <input type="text" class="form-control" id="username" name="username" required>
                                </div>
                                <div class="mb-3">
                                    <label for="email-pw" class="form-label">이메일</label>
                                    <input type="email" class="form-control" id="email-pw" name="email" required>
                                    <div class="form-text">가입시 등록한 이메일을 입력하세요.</div>
                                </div>
                                <button type="submit" class="btn btn-primary">비밀번호 재설정</button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">홈으로 돌아가기</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 탭 이벤트 설정
        const triggerTabList = [].slice.call(document.querySelectorAll('#accountTabs button'))
        triggerTabList.forEach(function (triggerEl) {
            const tabTrigger = new bootstrap.Tab(triggerEl)
            triggerEl.addEventListener('click', function (event) {
                event.preventDefault()
                tabTrigger.show()
            })
        })
        
        // URL에 #password-reset이 있으면 비밀번호 찾기 탭을 활성화
        if (window.location.hash === '#reset-password') {
            const passwordTab = document.querySelector('#find-pw-tab')
            if (passwordTab) {
                const tab = new bootstrap.Tab(passwordTab)
                tab.show()
            }
        }
    })
</script>
{% endblock %} 